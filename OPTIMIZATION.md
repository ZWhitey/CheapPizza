# 優惠碼搜尋優化分析

## 摘要

基於 853 個已收集的有效優惠碼分析，使用 10 位數區段優化搜尋範圍，將掃描代碼數量從 5000 減少到 2400，**減少 52% 的掃描時間**，同時**保留所有有資料的區段以確保不遺漏任何優惠碼**。

## 優化策略

1. **使用 10 位數區段** (如 150xx, 151xx, 252xx) 而非 100 位數區段
2. **保留所有有資料的區段** - 即使只有 1 個優惠碼也保留
3. **只移除完全沒有資料的範圍** (14xxx)
4. **零遺漏風險** - 確保不會錯過任何有效優惠碼

## 分析結果

### 15xxx 系列
- **有效優惠碼數量**: 500
- **範圍**: 15002 - 15822
- **密度**: 60.90%
- **有資料的 10 位數區段**:
  - 150xx: 27 個優惠碼
  - 151xx: 18 個優惠碼
  - 152xx: 30 個優惠碼
  - 153xx: 55 個優惠碼
  - 154xx: 82 個優惠碼
  - 155xx: 82 個優惠碼
  - 156xx: 84 個優惠碼
  - 157xx: 99 個優惠碼
  - 158xx: 23 個優惠碼

**優化建議**: 掃描 15000-15899 (9個區段，全部保留)

### 25xxx 系列
- **有效優惠碼數量**: 47
- **範圍**: 25313 - 25994
- **密度**: 6.89%
- **有資料的 10 位數區段**:
  - 253xx: 7 個優惠碼
  - 254xx: 5 個優惠碼
  - 255xx: 5 個優惠碼
  - 256xx: 1 個優惠碼
  - 257xx: 7 個優惠碼
  - 259xx: 22 個優惠碼

**優化建議**: 掃描 6 個有資料的區段 (包含 256xx，雖然只有 1 個優惠碼)

### 26xxx 系列
- **有效優惠碼數量**: 300
- **範圍**: 26300 - 26692
- **密度**: 76.34%
- **有資料的 10 位數區段**:
  - 263xx: 93 個優惠碼
  - 264xx: 51 個優惠碼
  - 265xx: 86 個優惠碼
  - 266xx: 70 個優惠碼

**優化建議**: 掃描 26300-26699 (4個區段，全部保留)

### 14xxx 系列
- **有效優惠碼數量**: 0
- **結果**: 完全移除此範圍

### 94xxx 系列
- **有效優惠碼數量**: 6
- **範圍**: 94103 - 94700
- **密度**: 1.00%
- **有資料的 10 位數區段**:
  - 941xx: 2 個優惠碼
  - 942xx: 1 個優惠碼
  - 945xx: 1 個優惠碼
  - 946xx: 1 個優惠碼
  - 947xx: 1 個優惠碼

**優化建議**: 保留 5 個有資料的區段 (確保不遺漏這 6 個優惠碼)

## 優化後的掃描範圍

```typescript
const DEFAULT_RANGES = [
  // 15xxx series (500 coupons across 9 segments)
  '15000-15099', '15100-15199', '15200-15299', '15300-15399', 
  '15400-15499', '15500-15599', '15600-15699', '15700-15799', '15800-15899',
  // 25xxx series (47 coupons across 6 segments)
  '25300-25399', '25400-25499', '25500-25599', '25600-25699', '25700-25799', '25900-25999',
  // 26xxx series (300 coupons across 4 segments)
  '26300-26399', '26400-26499', '26500-26599', '26600-26699',
  // 94xxx series (6 coupons across 5 segments)
  '94100-94199', '94200-94299', '94500-94599', '94600-94699', '94700-94799'
];
```

## 效能提升

- **原始掃描範圍**: 5000 個代碼 (14000-14999, 15000-15999, 25000-25999, 26000-26999, 94000-94999)
- **優化後掃描範圍**: 2400 個代碼 (24個區段)
- **減少**: 52.0%
- **預估時間節省**: 10.8 分鐘 (基於每個代碼 250ms 的延遲設定，見 crawler.ts:273)
- **資料覆蓋**: 100% - 保留所有有資料的區段

> **注意**: 實際時間節省取決於網路條件和 API 回應時間。250ms 的延遲是在爬蟲中設定的請求間隔。

## 優化策略

1. **移除無效範圍**: 14xxx 完全沒有有效優惠碼
2. **保留所有有資料的區段**: 使用 10 位數區段 (如 150xx, 251xx)，只要有任何資料就保留
3. **包含低密度區段**: 即使 256xx 只有 1 個優惠碼，94xxx 只有 6 個優惠碼，也全部保留
4. **零遺漏風險**: 確保 100% 覆蓋所有已知的有效優惠碼

## 未來建議

1. 定期重新分析優惠碼分佈，調整搜尋範圍
2. 如果發現新的 10 位數區段有優惠碼，立即加入掃描範圍
3. 監控新發現的優惠碼，如果出現在優化範圍外，考慮擴展範圍
4. 季度檢視是否有完全沒有資料的區段可以移除

## 如何使用

優化後的範圍已自動套用在 `crawler.ts` 的 `DEFAULT_RANGES` 常數中。執行爬蟲時無需額外設定：

```bash
npx tsx crawler.ts
```

如需手動指定範圍：

```bash
npx tsx crawler.ts 15000-15999 26300-26699
```
